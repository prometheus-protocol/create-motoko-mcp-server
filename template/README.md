# My Awesome MCP Server

This project was generated by `create-motoko-mcp-server` and provides a complete, ready-to-deploy Motoko MCP server for the [Prometheus Protocol](https://github.com/prometheus-protocol/prometheus-protocol) ecosystem.

## Prerequisites

Before you begin, make sure you have the following tools installed on your system:

1.  **DFX:** The DFINITY Canister SDK. [Installation Guide](https://dfinity.org/developers).
2.  **Node.js:** Required for package management and running scripts. [Download](https://nodejs.org/).
3.  **MOPS:** The Motoko Package Manager. [Installation Guide](https://mops.one/docs/install).
4.  **Prometheus Protocol CLIs:** These are the tools you'll use to interact with the Prometheus ecosystem.

    ```bash
    # Install the CLI for the App Store
    npm install -g @prometheus-protocol/cli

    # Install the CLI for the OAuth Server (for monetization)
    npm install -g @prometheus-protocol/typescript-sdk
    ```

    You can verify the installations by running `prom-cli --version` and `prom-oauth-cli --version`.

---

## Part 1: Get an Instant Win

This section guides you from zero to a working, testable MCP server in minutes. The default tool is public and requires no authentication.

### Step 1: Deploy Your Server

1.  **Install Dependencies:**
    ```bash
    npm install
    mops install
    ```
2.  **Start the Local Replica:**
    ```bash
    dfx start --background
    ```
3.  **Deploy to the Local Replica:**
    ```bash
    dfx deploy
    ```

### Step 2: Test with the MCP Inspector

Your server is live and its default `echo` tool is ready to use.

1.  **Launch the Inspector:**
    ```bash
    npx @modelcontextprotocol/inspector
    ```
2.  **Connect to Your Canister:** Use the local canister ID endpoint provided in the `dfx deploy` output.
    ```
    # Replace `your_canister_id` with the actual ID from the deploy output
    http://127.0.0.1:4943/?canisterId=your_canister_id
    ```
ðŸŽ‰ **Congratulations!** You have a working MCP server.

---

## Part 2: Enable Monetization (Optional)

Ready to add paid tools? Follow these steps to enable the Prometheus OAuth flow.

### Step 1: Activate the Auth Code in Your Canister

1.  Open `src/main.mo`.
2.  Uncomment the large block of code that initializes the `authContext`.
3.  Save the file.
4.  Run `dfx deploy` again to update your canister with the authentication logic.

Your server's tools are now protected and require a valid token to be called.

### Step 2: Register with the OAuth Server

1.  **Register Your Server:** This command registers your application as a client with the OAuth provider.
    ```bash
    prom-oauth-cli register
    ```
2.  **Configure for Local Development:** For local testing, you must update the registered `redirect_uri` to point to your local canister's endpoint.
    ```bash
    prom-oauth-cli update
    ```
    When prompted, change the `redirect_uri` to your local canister URL (e.g., `http://127.0.0.1:4943/?canisterId=your_canister_id`).

Your server is now a fully protected resource that can be tested with the OAuth flow.

---

## Part 3: Publish to the Prometheus App Store

This section guides you through submitting your server for verification and discovery.

### Step 1: Configure Your Manifest

The `prometheus.yml` file in your project root is the master record for your application's listing in the App Store.

1.  **Update Metadata:** Open `prometheus.yml` and fill in your application's details like `name`, `publisher`, and `description`.
2.  **Get Your Git Commit Hash:** The manifest requires the exact Git commit hash of the code you are deploying. First, commit your changes, then run this command to get the hash:
    ```bash
    git rev-parse HEAD
    ```
    Copy the output hash and paste it into the `git_commit` field in your `prometheus.yml`.

### Step 2: Submit Your Application

With your manifest configured, you can now submit your server to the App Store.

```bash
# This command reads your manifest, computes the WASM hash, and submits it
prom-cli submit
```

Your application is now submitted! It will NOT be visible in the App Store until it passes the required `app_info_v1` audit.

### Step 3: Monitor Verification Status

You can check the status of your submission at any time.

```bash
prom-cli status
```

This will show you which audits are required for your application and which ones are still pending. As independent auditors review your code and submit their attestations, this status will update automatically. Once all required audits are complete and finalized by the DAO, your server will receive its official verification tier!

---

## Deploying to Production

1.  **Deploy to the IC Mainnet:**
    ```bash
    dfx deploy --network ic
    ```

2.  **Update OAuth Redirect URI:** **(Important!)** If you enabled monetization, you must run `prom-oauth-cli update` again and change the `redirect_uri` back to your production URL.
    ```
    # Production Canister URL
    https://your_canister_id.icp0.io/
    ```

## What's Next?

-   **Customize Your Tool:** Open `src/main.mo` to start building your own custom MCP tools.
-   **Learn More:** Check out the [Motoko MCP SDK documentation](https://github.com/prometheus-protocol/motoko-sdk) for advanced features like adding paid tools, handling state, and more.